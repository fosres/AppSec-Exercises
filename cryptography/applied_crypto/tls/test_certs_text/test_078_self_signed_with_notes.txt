# TEST 078: Self-Signed Certificate with Field Order Challenge
#
# PURPOSE: Test if validator correctly detects self-signed certificates
# regardless of DN field order.
#
# CHALLENGE: Some CAs format DNs in different orders:
#   OpenSSL style: C, ST, L, O, OU, CN
#   Microsoft CA:  CN, OU, O, L, ST, C (reversed!)
#
# A naive validator might do:
#   if issuer_string == subject_string: self_signed = True
#
# This FAILS when same fields are in different order!
#
# CORRECT APPROACH: Parse DNs into dictionaries, compare field-by-field
#
# In this test, both Issuer and Subject have the same order (self-signed),
# but students should implement parsing that would work even if they were
# in different orders.
#
# Expected result: CHECK 15 should FAIL (self-signed detected)
#
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            2d:a1:50:fc:e8:9e:b6:1e:d6:9f:a7:4b:f3:5b:77:5c:5c:e5:d6:16
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = Test Self-Signed CA, O = Test Self-Signed Inc, L = San Francisco, ST = California, C = US
        Validity
            Not Before: Jan 26 20:00:07 2026 GMT
            Not After : Jan 26 20:00:07 2027 GMT
        Subject: CN = Test Self-Signed CA, O = Test Self-Signed Inc, L = San Francisco, ST = California, C = US
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:e6:d7:ed:9c:78:ee:6e:5d:47:a5:19:35:1c:a3:
                    28:46:3d:60:8a:7f:e0:48:e2:04:d6:98:17:06:a8:
                    fa:59:5e:d8:bb:7a:50:d3:03:35:74:1b:63:c4:7d:
                    db:bd:2a:59:c4:11:de:3e:12:2c:03:18:57:83:3c:
                    14:eb:72:0a:bf:15:b5:0a:14:2f:96:85:9f:ef:e4:
                    b3:15:b4:a2:d6:06:ac:f3:23:bc:7c:a1:c3:5c:21:
                    a7:0c:5f:29:be:3d:2c:ad:0d:6f:05:d4:f9:67:d3:
                    98:2d:ea:c7:46:43:8a:44:66:24:3e:59:43:23:65:
                    24:18:01:75:60:61:56:e6:0e:4f:16:cf:bc:51:1d:
                    c5:c5:71:a5:cd:da:07:64:4d:77:8a:8c:27:fe:39:
                    6e:09:cd:40:9d:86:83:7b:70:c8:1a:22:e1:c2:4c:
                    3d:28:16:6d:f7:51:43:e4:13:84:85:e5:ab:23:49:
                    04:be:96:b1:ec:b3:27:e0:d5:ca:4e:3d:10:bc:16:
                    aa:cd:2f:c9:f9:16:00:47:25:21:cd:2c:8b:bd:e0:
                    e5:d9:4a:0d:80:dc:f2:a1:99:34:83:cf:06:8c:03:
                    60:a8:47:0f:d7:77:6f:2b:88:18:9c:45:aa:83:99:
                    54:66:18:17:25:68:61:34:3d:b6:a2:48:76:e5:c7:
                    83:69
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                CE:AF:DA:4A:68:E3:F0:76:39:49:25:C9:5B:80:E6:8D:F4:04:CE:42
            X509v3 Authority Key Identifier: 
                CE:AF:DA:4A:68:E3:F0:76:39:49:25:C9:5B:80:E6:8D:F4:04:CE:42
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        a1:7a:fe:6d:ff:d8:d0:f6:c8:0a:26:eb:94:aa:9d:34:a4:61:
        11:5c:1c:11:34:a7:29:b9:c0:40:3c:b6:c1:dc:af:94:b4:1b:
        fd:26:59:39:df:ee:99:db:5a:fa:ee:80:70:b0:e1:ac:71:93:
        9b:0e:d7:29:1a:4f:f4:ab:55:47:22:5f:cf:fb:b7:70:31:22:
        bd:a5:91:63:63:7c:6f:62:1b:e7:6f:0e:85:b8:05:70:cc:f0:
        f7:be:1e:c0:15:6e:90:c5:a2:51:87:ef:99:00:8b:ab:7a:08:
        4c:51:f7:43:e0:5b:01:8f:ce:38:f7:ea:82:f3:e5:f0:9b:bf:
        eb:f8:95:cc:03:4c:35:4e:b7:e2:35:2a:bc:2f:f3:fa:2e:85:
        ee:c1:b1:94:d3:a2:17:38:2f:3f:b4:f7:71:21:a0:1c:fc:6c:
        d0:3a:a5:ad:34:5a:62:e1:73:65:72:34:31:70:31:a6:bb:0c:
        c7:a4:8c:4f:67:02:1e:e0:b0:65:c9:ea:05:21:1a:d5:8e:ad:
        50:47:10:cd:8b:55:bc:65:e2:86:b6:e4:79:46:22:e0:0c:90:
        2f:c3:0e:18:a5:dd:07:78:b7:5c:4e:59:6f:a9:3f:d4:f5:37:
        58:f8:eb:8c:ae:a3:20:5e:66:af:dd:31:34:0c:e0:4f:e9:c0:
        64:15:77:ef
